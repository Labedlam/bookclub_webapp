/*! primepersonalproject 2015-12-07 */
myApp.controller("BaseController",["$scope","$http","DataService","DataServiceReg","$mdToast","$document",function(a,b,c,d,e,f){function g(){void 0===a.dataService.userData()?(a.dataService.retrieveData().then(function(){a.users=a.dataService.userData()}),console.log("Base Async: ",a.dataService.userData())):a.users=a.dataService.userData()}function h(a){console.log("Is check ifusers have voted function being called?");for(var b=0,c=0;c<a.length;c++)1==a[c].prefBookVote?(b++,console.log("this user"+a[c]+"has voted",b)):console.log("this user"+a[c]+"has NOT Voted")}function i(){var b=a.toastPosition;b.bottom&&k.top&&(b.top=!1),b.top&&k.bottom&&(b.bottom=!1),b.right&&k.left&&(b.left=!1),b.left&&k.right&&(b.right=!1),k=angular.extend({},b)}function j(){b({method:"GET",url:"/voting/checkuservote"}).then(function(b){a.loggedInUser=b.data,console.log("this is my HasUserVotedFunction response",b.data),a.userVoteBookChoice=b.data[0],1==b.data[0].votePrefBook?(a.show=!1,a.showresult=!0):(a.show=!0,a.showresult=!1,console.log("this means that the scope.hide should be set to true ",b.data[0].votePrefBook))})}a.dataService=c,a.users=[],a.member={},a.prefBook={},a.bookclubUsers=[],a.loggedInUser={},a.loggedInBookClub={},a.usersInBookClub=[],a.show=!0,a.showResult=!1,g(),j(),console.log("hello BaseController here is promise",a.users),console.log(a.users),a.dataService1=d,a.bookclub=[],a.infobookclub={},void 0===a.dataService1.bookclubData()?(a.dataService1.retrieveData().then(function(){a.bookclub=a.dataService1.bookclubData()}),console.log("Base Async: for book promise",a.dataService1.bookclubData())):a.bookclub=a.dataService1.bookclubData(),console.log("I'm underneath the book promise"),h(a.users);var k={bottom:!1,top:!1,left:!0,right:!1};a.toastPosition=angular.extend({},k),a.getToastPosition=function(){return i(),Object.keys(a.toastPosition).filter(function(b){return a.toastPosition[b]}).join(" ")},a.userVoteBookChoice=[],a.bookmodel={},a.showActionToast=function(b,c){var d=e.simple().content("Are You Sure You Want To Vote For this Book?").action("ok").highlightAction(!0).parent(f[0].querySelector("#toastBounds")).hideDelay(1e5).position(a.getToastPosition());e.show(d).then(function(d){"ok"==d&&(console.log("this is what your sending back to the toast function ",b,c),a.selectedIndex=c,console.log("is scope.user anything ",a.user),a.userHasVoted(),console.log("Send up to votedbook route",b),a.votedBook(b),console.log("this is the book that was voted by user who logged in"),a.castPrefBookVote(b),j(),a.userVoteBookChoice=b[0],console.log("this is userobject[0]",b[0]))})},a.closeToast=function(){e.hide()},a.show=!0,a.showresult=!1,a.prefBookVote=!1,a.userHasVoted=function(){b({method:"PUT",url:"/voting/loggedin",data:{votePrefBook:"true"}}).then(function(b){console.log("does the book club objectcome down here?",b),a.prefBookVote=b.data})},a.votedBook=function(c){console.log("this is pref book",c);var d={title:c[0].title,author:c[0].author,summary:c[0].summary};console.log("here is whats beening sent up to cast vote",d),b({method:"PUT",url:"/voting/uservotedbook",data:d}).then(function(b){console.log("here is the response from uservotedbook ",b.data),a.userVoteBookChoice=b.data,console.log("this is calling the book club promise")})},a.castPrefBookVote=function(c){console.log("this is pref book",c);var d={title:c[0].title,author:c[0].author,summary:c[0].summary,_id:c[0]._id};console.log("here is whats beening sent up to cast vote",d),b({method:"PUT",url:"/voting/updatebook",data:d}).then(function(b){console.log("here is the response from castvote ",b),a.usersInBookClub=b,console.log("this is calling the book club promise",a.bookclub)})}}]),myApp.controller("AnotherController",["$scope","DataService",function(a,b){a.dataService=b,a.bookclub=[],void 0===a.dataService.bookclubData()?(a.dataService.retrieveData().then(function(){a.bookclub=a.dataService.bookclubData()}),console.log("Base Async: ",a.dataService.bookclubData())):a.bookclub=a.dataService.bookclubData()}]),myApp.controller("toolbarController",["$scope",function(a){a.isOpen=!1,a.demo={isOpen:!0,count:0,selectedDirection:"right"}}]);